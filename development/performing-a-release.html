<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M19 from src/site/apt/development/performing-a-release.apt at 2024-11-17
 | Rendered using Apache Maven Fluido Skin 2.0.0-M10
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M19" />
    <meta name="author" content="Trygve Laugstol" />
    <title>Performing a Release – Mojo Haus Site</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.0.0-M10.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.0.0-M10.min.js"></script>
    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        _paq.push(['disableCookies']);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);

        (function() {
            var u="https://analytics.apache.org/";
            _paq.push(['setTrackerUrl', u+'/matomo.php']);
            _paq.push(['setSiteId', '18']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->
    <style>.github-fork-ribbon:before { background-color: gray; }</style>
  </head>
  <body>
    <a class="github-fork-ribbon right-top" href="https://github.com/mojohaus/mojo-site" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1><a href=".././"><img class="imageLink" src="../images/mojo_logo.png" alt="MojoHaus" /></a></h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li><a href=".././">MojoHaus</a><span class="divider">/</span></li>
    <li class="active">Performing a Release <a href="https://github.com/mojohaus/mojohaus.github.io/tree/site/src/site/apt/development/performing-a-release.apt"><img src="../images/accessories-text-editor.png" alt="Edit" /></a></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2024-09-15</li>
        <li class="pull-right"><a href="https://maven.apache.org/" class="externalLink">Maven</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">MojoHaus</li>
    <li><a href="../index.html">Introduction</a></li>
    <li><a href="../plugins.html">Plugins</a></li>
    <li><a href="../faq.html">FAQ</a></li>
   <li class="nav-header">Contribution</li>
    <li><a href="../mailing-lists.html">Mailing Lists</a></li>
    <li><a href="../contribution/reporting-an-issue.html">Reporting an Issue</a></li>
    <li><a href="../contribution/submitting-a-patch.html">Submitting a Patch</a></li>
    <li><a href="../contribution/submitting-a-plugin.html">Submitting a Plugin</a></li>
   <li class="nav-header">Development</li>
    <li><a href="../development/guidelines.html">Development Guidelines</a></li>
    <li><a href="../development/process.html">Development Process</a></li>
    <li class="active"><a>Performing a Release</a></li>
   <li class="nav-header">Sub-projects</li>
    <li><a href="../animal-sniffer">Animal sniffer</a></li>
    <li><a href="../signatures">API Signatures</a></li>
    <li><a href="../extra-enforcer-rules">Extra enforcer rules</a></li>
    <li><a href="../mrm">Mock Repository Manager</a></li>
    <li><a href="../mojo-parent">Mojo Parent</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="Performing_a_Release"></a>
<h1>Performing a Release</h1>
<p>This is a check list of stuff that has to be done before a new version of a plugin is released.</p>
<ul>
<li><a href="#Preparing_to_Release">Preparing to Release</a></li>
<li><a href="#Preparing_for_the_First_Production_Release">Preparing for the First Production Release</a></li>
<li><a href="#Making_GPG_Keys">Making GPG Keys</a></li>
<li><a href="#Importing_CA_Certificates">Importing CA Certificates</a></li>
<li><a href="#Preparing_your_environment">Preparing your environment</a></li>
<li><a href="#Staging_the_Release">Staging the Release</a></li>
<li><a href="#Call_a_Vote">Call a Vote</a></li>
<li><a href="#Promoting_the_Release">Promoting the Release</a></li>
<li><a href="#Dropping_the_Release">Dropping the Release</a></li>
<li><a href="#Releasing_the_MojoHaus_Parent_POM">Releasing the MojoHaus Parent POM</a></li></ul><section>
<h2><a id="Preparing_to_Release">Preparing to Release</a></h2>
<ul>
<li>Make sure the site documentation is up to date and follows the <a href="./guidelines.html">Development Guidelines</a>.</li>
<li>All open GitHub issues should be closed or agreed to be scheduled for a future version. </li>
<li>Plugin must be documented and preferably have unit and integration tests.</li>
<li>If <code>changes-report</code> of <a class="externalLink" href="https://maven.apache.org/plugins/maven-changes-plugin/">maven-changes-plugin</a> is used, update <code>changes.xml</code> to include all issues in GitHub that were fixed. (If <code>github-report</code> is used, this information is retrieved automatically from GitHub.)</li>
<li>If the release is a bugfix release (incrementing z): explicitly document the bugs fixed.</li>
<li>If the release is a minor release (incrementing y): document the new features added. Make sure that these new features are properly documented, including:
<ul>
<li>Javadoc tags if the Mojo is written in Java</li></ul></li>
<li>Make sure you include the correct information in the <code>scm</code> section:
<pre class="prettyprint"><code>&lt;project&gt;
  &lt;scm&gt;
    &lt;connection&gt;scm:git:https://github.com/mojohaus/PLUGIN_NAME.git&lt;/connection&gt;
    &lt;developerConnection&gt;scm:git:ssh://git@github.com/mojohaus/PLUGIN_NAME.git&lt;/developerConnection&gt;
    &lt;url&gt;https://github.com/mojohaus/PLUGIN_NAME&lt;/url&gt;
  &lt;/scm&gt;
&lt;/project&gt;</code></pre></li>
<li>Verify that the project doesn't depend on SNAPSHOTs anymore (the <a class="externalLink" href="https://maven.apache.org/plugins/maven-release-plugin/examples/prepare-release.html">maven-release-plugin</a> will check this too)</li>
<li>Ensure the plugin complies with its intended minimum JRE requirement. For instance, if Java 1.5 is to be supported, actually set your <code>JAVA_HOME</code> to a JDK 1.5 and run <code>mvn clean verify</code>. This will catch references to classes or methods that were accidentally used but are only available in later versions of Java. Also consider to add our <a href="/animal-sniffer/animal-sniffer-maven-plugin/">animal-sniffer-maven-plugin</a> which can check the code against the signature of the required JDK version.</li>
<li>To <i>generate</i> the documentation of the plugin, you will need to use at least Maven 2.1.0 because of the <a class="externalLink" href="https://maven.apache.org/plugins/maven-site-plugin/">maven-site-plugin</a> preconfigured in the mojo-parent. To <i>deploy</i> you can't use Maven 2.1.0 or 2.2.0, because they produce incorrect GPG signatures and checksums respectively. This means it requires at least Maven 2.2.1 to perform a complete release. But this doesn't mean you can't use an earlier version of Maven to <i>build</i> or <i>use</i> this plugin.</li></ul>
<ul>
<li>Check that the POM properly declares its dependencies, i.e. run <code>mvn dependency:analyze</code> and fix any problems.</li>
<li>To be able to use the maven-release-plugin you need to have a git client available on your system path. To verify if it's there, execute <code>git help</code> on the project root. </li>
<li>Be sure you have generated a gpg-key before performing the release. </li></ul></section><section>
<h2><a id="Preparing_for_the_First_Production_Release">Preparing for the First Production Release</a></h2>
<p>When a plugin is ready to have its first production release (i.e. not an alpha or beta release) there are a couple of extra things that needs to be taken care of:</p>
<ul>
<li>Check GitHub issue configuration.</li>
<li>Make sure that the plugin's site passes the documentation checker plugin test. Run 
<pre class="prettyprint"><code>mvn docck:check</code></pre>
<p>If there are any errors - fix them. There are a couple of errors that might not need to be fixed. As an example: it's better <i>not</i> to add an FAQ document than to add a bogus one.</p></li></ul></section><section>
<h2><a id="Making_GPG_Keys">Making GPG Keys</a></h2>
<p>Before releasing for the first time you have to generate a GPG key and publish it. Information can also be found on Sonatype's <a class="externalLink" href="http://blog.sonatype.com/2010/01/how-to-generate-pgp-signatures-with-maven/">How to Generate PGP Signatures with Maven</a>.</p>
<ul>
<li>Download GPG from <a class="externalLink" href="http://www.gnupg.org/download/">http://www.gnupg.org/download/</a>, follow the instructions and install it to your system. Verify your gpg installation by running gpg with the version flag, i.e. <code>gpg --version</code></li>
<li>Execute <code>gpg --full-generate-key</code> and answer the questions. Most of the time you can use the default.
<table class="table table-bordered table-striped">
<tr class="a">
<td style="text-align: left;">Please select what kind of key you want:&#xa0;<br />(1) RSA and RSA (default)&#xa0;<br />(2) DSA and Elgamal&#xa0;<br />(3) DSA (sign only)&#xa0;<br />(4) RSA (sign only)&#xa0;<br />(7) DSA (set your own capabilities)&#xa0;<br />(8) RSA (set your own capabilities)&#xa0;<br />(9) ECC and ECC&#xa0;<br />(10) ECC (sign only)&#xa0;<br />(11) ECC (set your own capabilities)&#xa0;<br />(13) Existing key&#xa0;<br />(14) Existing key from card</td>
<td style="text-align: left;">9</td></tr>
<tr class="b">
<td style="text-align: left;">Please select which elliptic curve you want:&#xa0;<br />(1) Curve 25519&#xa0;<br />(3) NIST P-256&#xa0;<br />(4) NIST P-384&#xa0;<br />(5) NIST P-521&#xa0;<br />(6) Brainpool P-256&#xa0;<br />(7) Brainpool P-384&#xa0;<br />(8) Brainpool P-512&#xa0;<br />(9) secp256k1</td>
<td style="text-align: left;">1</td></tr>
<tr class="a">
<td style="text-align: left;">Please specify how long the key should be valid.&#xa0;<br />0 = key does not expire&#xa0;<br /><i>n</i> = key expires in n days&#xa0;<br /><i>n</i>w = key expires in n weeks&#xa0;<br /><i>n</i>m = key expires in n months&#xa0;<br /><i>n</i>y = key expires in n years</td>
<td style="text-align: left;">4y</td></tr>
<tr class="b">
<td style="text-align: left;">Real name:</td>
<td style="text-align: left;"><i>your real name</i></td></tr>
<tr class="a">
<td style="text-align: left;">Email address:</td>
<td style="text-align: left;"><i>your email address</i></td></tr>
<tr class="b">
<td style="text-align: left;">Comment</td>
<td style="text-align: left;"><i>empty</i></td></tr>
<tr class="a">
<td style="text-align: left;">Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?</td>
<td style="text-align: left;">O</td></tr></table></li>
<li>Execute <code>gpg --list-sigs &quot;</code><i>your real name</i><code>&quot; &amp;&amp; gpg --armor --export &quot;</code><i>your real name</i><code>&quot;</code> and visit <a class="externalLink" href="https://hkps.pool.sks-keyservers.net/">https://hkps.pool.sks-keyservers.net/</a> to distribute your public key, so users can verify your files. This webpage contains a form where you have to copy your key. </li>
<li>Update <a class="externalLink" href="https://github.com/mojohaus/mojohaus.github.io/blob/site/src/site/resources/KEYS">https://github.com/mojohaus/mojohaus.github.io/blob/site/src/site/resources/KEYS</a> by expanding this file with your key. If you deploy the site by running <code>mvn -Preporting verify site site:stage scm-publish:publish-scm</code> the key will become available on the mojo-site. Since all mojo-developers should put their key here it's easy for users to verify mojo-artifacts. </li></ul></section><section>
<h2><a id="Preparing_your_environment">Preparing your environment</a></h2>
<p>For any deployment you have to make contact with oss.sonatype.org, for which authentication is required. The best way to do this is to include the following sections in your personal <code>settings.xml</code> and fill in the <code>oss-sonatype.username</code> and <code>oss-sonatype.password</code> properties with your own credentials.</p>
<pre class="prettyprint"><code>&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
          xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;ossrh-staging&lt;/id&gt; &lt;!-- used for release deployment --&gt;
      &lt;username&gt;jqhacker&lt;/username&gt; &lt;!-- oss-sonatype.username --&gt;
      &lt;password&gt;SeCrEt&lt;/password&gt; &lt;!-- oss-sonatype.password --&gt;
    &lt;/server&gt;           
    &lt;server&gt;
      &lt;id&gt;ossrh-snapshots&lt;/id&gt; &lt;!-- used for snapshot deployment --&gt;
      &lt;username&gt;jqhacker&lt;/username&gt; &lt;!-- oss-sonatype.username --&gt;
      &lt;password&gt;SeCrEt&lt;/password&gt; &lt;!-- oss-sonatype.password --&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;          </code></pre>
<p>(Note that using <a class="externalLink" href="https://maven.apache.org/guides/mini/guide-encryption.html#How_to_encrypt_server_passwords">Maven password encryption</a> is possible but may not work in combination with the <code>oss-sonatype.password</code> property, perhaps due to difficulties with brace expansion. Instead, duplicate your encrypted password into each of the <code>server</code> sections.)</p></section><section>
<h2><a id="Staging_the_Release">Staging the Release</a></h2>
<p>The release process should be done using the <a class="externalLink" href="https://maven.apache.org/plugins/maven-release-plugin/">Maven Release Plugin</a>:</p>
<ul>
<li>Execute <code>mvn release:prepare</code>
<p>This will make sure all code is checked in, tag the release and make sure the POM has no snapshot dependencies. Make sure that you are able to push changes and tags via SSH</p></li>
<li>Execute <code>mvn release:perform</code>
<p>This will build the plugin, javadocs and source. Everything will be deployed to the Nexus Repository Manager of Sonatype OSSRH, ready to be staged. (This will typically not build the site.)</p></li>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Close&quot; the staging repository.</li>
<li>Build and deploy the plugin site
<p>Typically, the command is <code>cd target/checkout</code> then <code>mvn verify site site:stage scm-publish:publish-scm</code> on a mono-module plugin but could vary. Consult the mojo's README file.</p>
<p>You may need to configure a ssh key to your GitHub account: see GitHub's <a class="externalLink" href="https://help.github.com/articles/connecting-to-github-with-ssh/"> Connecting to GitHub with SSH</a> guide.</p>
<p>For the first site deployment, when <code>gh-pages</code> branch does not exist yet, you'll need to do the job by hand: create an orphan branch <code>git checkout --orphan gh-pages</code>, then clean it <code>rm .git/index ; git clean -fdx</code> before copying initial site content, committing and pushing.</p></li>
<li>Verify that the plugin site deployment occurred successfully.</li>
<li>Draft a release in GitHub
<p>Go to the release tag in GitHub: https://github.com/mojohaus/PLUGIN_NAME/releases and select the release you've staged</p>
<p>Via &quot;Edit Tag&quot; provide a link to the Changelog in for this release in the description (e.g. linking to the GitHub milestone list of closed tickets)</p>
<p>Mark the release as &quot;pre-release&quot; while it's under the voting process</p></li></ul></section><section>
<h2><a id="Call_a_Vote">Call a Vote</a></h2>
<p>Before a release can occur, an optional vote may take place. This is initiated with an email to the <a class="externalLink" href="mailto:mojohaus-dev@googlegroups.com">dev list</a>, preferrably with a subject that starts with <code>[VOTE]</code>. Explain the plugin, status and any other info you feel relevant. The standard is to wait 72 hours for responses. This gives other developers time to verify the quality of the plugin before placing their vote. See the <a class="externalLink" href="http://www.apache.org/foundation/voting.html">Apache Voting Guidelines</a> for more information. You can use a <a href="./releasevote-mailtemplate.html">template</a> to be sure your email contains all the expected information.</p></section><section>
<h2><a id="Promoting_the_Release">Promoting the Release</a></h2>
<p>When the vote (if any) has passed, do the following:</p>
<ul>
<li>Reply to the latest vote and summarize the result and prefix the subject with <b>[RESULT]</b>.</li>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Release&quot; the staging repository.</li>
<li>Wait some time and find the artifacts synced on central. The synchronization typically occurs every 4 hours but allow for it take up to 24 hrs.</li>
<li>Close the current milestone in github, and create new milestone(s) as required.</li>
<li>Remove the &quot;pre-release&quot; tag from the release tag in GitHub</li>
<li>Send out an annoucement email to <a class="externalLink" href="mailto:mojohaus-dev@googlegroups.com">mojohaus-dev@googlegroups.com</a> and <a class="externalLink" href="mailto:users@maven.apache.org">users@maven.apache.org</a>. You can use a <a href="./announcement-mailtemplate.html">template</a> to be sure your email contains all the expected information. Ensure you've subscribed to all these mailing lists, otherwise the message will be bounced.</li>
<li>TODO: if there's a feed containing all releases, get the release into that feed.</li></ul></section><section>
<h2><a id="Dropping_the_Release">Dropping the Release</a> </h2>
<p>If the vote failed, the following steps have to be taken:</p>
<ul>
<li>Log into <a class="externalLink" href="https://oss.sonatype.org/">https://oss.sonatype.org/</a> and &quot;Drop&quot; the staging repository.</li>
<li>Rollback any SCM-changes. Be aware that the <code>release:rollback</code> doesn't remove the tag. You must do this by hand, use <code>git tag -d myplugin-1.2.3</code>.</li>
<li>To remove a remote tag on GitHub, use <code>git push origin :refs/tags/myplugin-1.2.3</code></li>
<li>Run <code>siteskinner:skin -DsiteDeploy</code> to restore the documention of the latest released plugin.</li></ul></section><section>
<h2><a id="Releasing_the_Mojo_Parent_POM">Releasing the Mojo Parent POM</a></h2>
<p>Of course, to release the Mojo Parent POM, a vote takes place just for an ordinary plugin release. But when it comes to actually perform the release, there are some differences to watch out for:</p>
<ol style="list-style-type: decimal;">
<li>Execute <code>mvn release:prepare</code></li>
<li>Execute <code>mvn release:perform -Dgoals=deploy</code>
<p>The important thing to note here is the parameter <code>-Dgoals=deploy</code>. By default, the Release Plugin would execute the phases <code>deploy</code> and <code>site-deploy</code> on the parent POM. However, the site of the parent POM is not meant to be deployed, we have a separate project for this. The configuration of the site distribution in the parent POM exists solely for the purpose of inheritance by the plugins. Accidentally deploying the parent's site would damage the Mojo website, most notably the <code>index.html</code>.</p></li>
<li>Test that the new parent is working
<p>Manually update (without committing) one or two plugins on your local machine to use the new parent. Then run:</p>
<p><code>mvn clean verify site -Pmojo-release</code></p></li>
<li>Update the <a href="./guidelines.html">Development Guidelines</a> to indicate the new POM version.</li></ol></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2024
<a href="https://www.mojohaus.org">MojoHaus</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>